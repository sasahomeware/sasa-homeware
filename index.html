<!DOCTYPE html>
<html>
<head>
  <title>SASA Interiors AR Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #ffffff;
    }
    
    /* Hide AR button on desktop, show only on mobile */
    #ar-button {
      display: none;
    }

    /* Show only on touch-enabled mobile devices */
    @media (hover: none) and (pointer: coarse) {
      #ar-button {
        display: block;
      }
    }

    /* Additional check: hide on desktop even if screen is small */
    @media (hover: hover) and (pointer: fine) {
      #ar-button {
        display: none !important;
      }
    }
    
    /* Glassmorphic button (no orb) */
    #ar-button { position: relative; overflow: visible; }
    
    /* Mobile-specific button sizing */
    @media (max-width: 450px) {
      #ar-button {
        padding: 1px 10px !important;
        font-size: 11px !important;
        line-height: 15 !important;
        height: 35px !important;
      }
      #ar-button img {
        width: 13px !important;
        height: 50px !important;
      }
    }
  </style>
</head>
<body>

  <model-viewer
      id="main-viewer"
      ar
      ar-modes="webxr scene-viewer quick-look"
      ar-scale="fixed"
      interaction-policy="allow-when-focused"
      camera-controls
      disable-zoom
      max-camera-orbit="Infinity 90deg auto"
      min-camera-orbit="-Infinity 0deg auto"
      camera-orbit="0deg 75deg 100%"
      field-of-view="30deg"
      shadow-intensity="1"
      environment-image="neutral"
      style="width: 100vw; height: 100vh; margin: 0; padding: 0; display: block; background-color: #ffffff;">
  </model-viewer>

  <button id="ar-button" onclick="modelViewer.activateAR()" style="
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    background: linear-gradient(135deg, rgba(0,0,0,0.06) 0%, rgba(255,255,255,0.96) 60%, rgba(255,255,255,1) 100%);
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 35px;
    padding: 2px 2px;
    cursor: pointer;
    font-weight: 500;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.85);
    transition: background 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
    box-shadow: 0 8px 40px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255, 255, 255, 0.9), inset 0 -1px 0 rgba(0, 0, 0, 0.06);
    display: inline-flex;
    align-items: center;
    gap: 10px;
  " onmouseover="this.style.background='white'; this.style.transform='translateY(-1px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.9)'; this.style.transform='translateY(0)'"><img src="./ar-cube.svg" alt="" style="width:50px;height:50px;vertical-align:middle;margin-right:0px" /><span>View in your room</span></button>

  <script>
    const modelViewer = document.querySelector('#main-viewer');
    const params = new URLSearchParams(window.location.search);
    const glbSrc = params.get('glb');

    // Load initial model if provided
    if (glbSrc) {
        modelViewer.src = glbSrc;
    }

    // Clean up URL without refreshing
    window.history.replaceState(
        {}, 
        document.title, 
        window.location.pathname
    );

    // Ensure AR scaling is disabled
    modelViewer.addEventListener('ar-status', (event) => {
        if (event.detail.status === 'session-started') {
            console.log('AR session started - scaling locked');
            // Additional AR scale locking if needed
            modelViewer.scale = '1 1 1';
        }
    });

    // No orb underlay/scripts needed
    
    </script>
<div id="ar-prompt">
    <img src="https://modelviewer.dev/shared-assets/icons/hand.png">
</div>
</body>
</html>
